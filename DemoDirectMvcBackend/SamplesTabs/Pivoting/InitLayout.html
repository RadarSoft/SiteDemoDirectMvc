private void InitLayout()
{
    THierarchy H = OlapAnalysis.Dimensions.FindHierarchyByDisplayName("Products by categories");
    H.TotalAppearance = TTotalAppearance.taInvisible;
    H.ShowEmptyLines = true;
    OlapAnalysis.PivotingLast(H, TLayoutArea.laRow);
    H = OlapAnalysis.Dimensions.FindHierarchyByDisplayName("Date");
    H.ShowEmptyLines = true;
    OlapAnalysis.PivotingLast(H, TLayoutArea.laColumn);

    TMeasure M = OlapAnalysis.Measures.FindByDisplayName("Sales");
    if (M != null)
        OlapAnalysis.Pivoting(M, TLayoutArea.laRow, null);

    M = OlapAnalysis.Measures.FindByDisplayName("Quantity");
    if (M != null)
        OlapAnalysis.Pivoting(M, TLayoutArea.laRow, null);
}